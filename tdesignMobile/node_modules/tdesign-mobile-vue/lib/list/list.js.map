{"version":3,"file":"list.js","sources":["../../src/list/list.vue","../../src/list/list.vue?vue&type=template&id=46128f6e&lang.js"],"sourcesContent":["<template>\n  <div ref=\"root\" :class=\"name\" @scroll=\"handleScroll\">\n    <t-node :content=\"headerContent\" />\n    <slot />\n    <div :class=\"`${name}__loading--wrapper`\" @click.stop=\"onLoadMore\">\n      <t-loading\n        v-if=\"typeof asyncLoading === 'string' && ['loading', 'load-more'].includes(asyncLoading)\"\n        :indicator=\"asyncLoading === 'loading'\"\n        :text=\"typeof asyncLoading === 'string' ? LOADING_TEXT_MAP[asyncLoading] : ''\"\n        :class=\"`${name}__loading`\"\n      />\n    </div>\n    <t-node :content=\"footerContent\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, getCurrentInstance } from 'vue';\nimport { useWindowSize, useEventListener } from '@vueuse/core';\nimport TLoading from '../loading';\nimport config from '../config';\nimport ListProps from './props';\nimport { renderTNode, TNode, useScrollParent } from '../shared';\nimport { useConfig } from '../config-provider/useConfig';\n\nconst { prefix } = config;\n\nconst name = `${prefix}-list`;\n\nexport default defineComponent({\n  name,\n  components: {\n    TLoading,\n    TNode,\n  },\n  props: ListProps,\n  emits: ['load-more', 'scroll'],\n  setup(props, context) {\n    const { globalConfig } = useConfig('list');\n\n    const LOADING_TEXT_MAP = {\n      loading: globalConfig.value.loading,\n      'load-more': globalConfig.value.loadingMoreText,\n    };\n\n    const root = ref<HTMLElement>();\n    const empty = ref<HTMLElement>();\n    const scrollParent = useScrollParent(root);\n    const { height } = useWindowSize();\n    const internalInstance = getCurrentInstance();\n\n    const headerContent = computed(() => renderTNode(internalInstance, 'header'));\n    const footerContent = computed(() => renderTNode(internalInstance, 'footer'));\n\n    const onLoadMore = (e: MouseEvent) => {\n      if (props.asyncLoading === 'load-more') {\n        props.onLoadMore?.();\n      }\n    };\n\n    const handleScroll = (e: WheelEvent | Event) => {\n      const scrollHeight =\n        (e.target as HTMLElement).scrollHeight ||\n        Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);\n      const scrollTop =\n        (e.target as HTMLElement).scrollTop || document.documentElement.scrollTop || document.body.scrollTop;\n      const offsetHeight = (e.target as HTMLElement).offsetHeight || height.value;\n\n      props.onScroll?.(scrollHeight - (scrollTop + offsetHeight), scrollTop);\n    };\n\n    useEventListener(scrollParent, 'scroll', handleScroll);\n\n    return {\n      name,\n      root,\n      empty,\n      onLoadMore,\n      handleScroll,\n      headerContent,\n      footerContent,\n      LOADING_TEXT_MAP,\n    };\n  },\n});\n</script>\n","<template>\n  <div ref=\"root\" :class=\"name\" @scroll=\"handleScroll\">\n    <t-node :content=\"headerContent\" />\n    <slot />\n    <div :class=\"`${name}__loading--wrapper`\" @click.stop=\"onLoadMore\">\n      <t-loading\n        v-if=\"typeof asyncLoading === 'string' && ['loading', 'load-more'].includes(asyncLoading)\"\n        :indicator=\"asyncLoading === 'loading'\"\n        :text=\"typeof asyncLoading === 'string' ? LOADING_TEXT_MAP[asyncLoading] : ''\"\n        :class=\"`${name}__loading`\"\n      />\n    </div>\n    <t-node :content=\"footerContent\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, computed, getCurrentInstance } from 'vue';\nimport { useWindowSize, useEventListener } from '@vueuse/core';\nimport TLoading from '../loading';\nimport config from '../config';\nimport ListProps from './props';\nimport { renderTNode, TNode, useScrollParent } from '../shared';\nimport { useConfig } from '../config-provider/useConfig';\n\nconst { prefix } = config;\n\nconst name = `${prefix}-list`;\n\nexport default defineComponent({\n  name,\n  components: {\n    TLoading,\n    TNode,\n  },\n  props: ListProps,\n  emits: ['load-more', 'scroll'],\n  setup(props, context) {\n    const { globalConfig } = useConfig('list');\n\n    const LOADING_TEXT_MAP = {\n      loading: globalConfig.value.loading,\n      'load-more': globalConfig.value.loadingMoreText,\n    };\n\n    const root = ref<HTMLElement>();\n    const empty = ref<HTMLElement>();\n    const scrollParent = useScrollParent(root);\n    const { height } = useWindowSize();\n    const internalInstance = getCurrentInstance();\n\n    const headerContent = computed(() => renderTNode(internalInstance, 'header'));\n    const footerContent = computed(() => renderTNode(internalInstance, 'footer'));\n\n    const onLoadMore = (e: MouseEvent) => {\n      if (props.asyncLoading === 'load-more') {\n        props.onLoadMore?.();\n      }\n    };\n\n    const handleScroll = (e: WheelEvent | Event) => {\n      const scrollHeight =\n        (e.target as HTMLElement).scrollHeight ||\n        Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);\n      const scrollTop =\n        (e.target as HTMLElement).scrollTop || document.documentElement.scrollTop || document.body.scrollTop;\n      const offsetHeight = (e.target as HTMLElement).offsetHeight || height.value;\n\n      props.onScroll?.(scrollHeight - (scrollTop + offsetHeight), scrollTop);\n    };\n\n    useEventListener(scrollParent, 'scroll', handleScroll);\n\n    return {\n      name,\n      root,\n      empty,\n      onLoadMore,\n      handleScroll,\n      headerContent,\n      footerContent,\n      LOADING_TEXT_MAP,\n    };\n  },\n});\n</script>\n"],"names":["prefix","config","name","defineComponent","components","TLoading","TNode","props","ListProps","emits","setup","context","_useConfig","useConfig","globalConfig","LOADING_TEXT_MAP","loading","value","loadingMoreText","root","ref","empty","scrollParent","useScrollParent","_useWindowSize","useWindowSize","height","internalInstance","getCurrentInstance","headerContent","computed","renderTNode","footerContent","onLoadMore","e","asyncLoading","_props$onLoadMore","call","handleScroll","_props$onScroll","scrollHeight","target","Math","max","document","documentElement","body","scrollTop","offsetHeight","onScroll","useEventListener","_createElementBlock","class","_ctx","apply","arguments","_createVNode","_component_t_node","content","_renderSlot","$slots","_createElementVNode","onClick","includes","_createBlock","_component_t_loading","indicator","text"],"mappings":"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"}